# 蔡司 AI 图片生成工具 - 使用指南

## 概述

这是一个用于生成蔡司眼镜配镜参数说明图的工具。支持：
- 基于 Gemini AI 生成 2K 高清图片
- 参考图上传 + AI 自动分析人物特征
- 多种图片比例选择
- 提示词模板管理

---

## 界面布局

```
┌─────────────┬────────────────────────────────────────┐
│             │                                        │
│   左侧导航   │              主工作区                  │
│             │                                        │
│  - 工作区    │  ┌──────────┬──────────────────────┐  │
│  - 任务列表  │  │ 参考图   │     提示词编辑       │  │
│  - 模板管理  │  │ +AI分析  │                      │  │
│  - 图库     │  ├──────────┼──────────────────────┤  │
│             │  │ 图片生成 │     选中图片展示     │  │
│             │  │ (4张2K)  │                      │  │
│             │  └──────────┴──────────────────────┘  │
└─────────────┴────────────────────────────────────────┘
```

---

## 完整工作流程

### 第一步：选择任务

1. 点击左侧导航的 **「任务列表」**
2. 任务按 5 个分类分组：
   - 瞳距偏差（3个任务）
   - 装配高度偏差（2个任务）
   - 镜眼距偏差（2个任务）
   - 倾斜角偏差（2个任务）
   - 镜面角偏差（2个任务）
3. 点击任意任务卡片，进入工作区开始制作

### 第二步：上传参考图（可选）

1. 在工作区左上角的 **「参考图」** 区域
2. 点击上传区域或拖拽图片上传
3. **新功能**：上传后 AI 自动分析人物特征：
   - 年龄、性别
   - 肤色、发型
   - 外貌描述
4. 分析结果可用于编写提示词

> **提示**：如果不上传参考图，AI 会随机生成人物形象

### 第三步：编辑提示词

1. 在 **「提示词」** 区域编写图片描述
2. 可以点击右上角 **「模板」** 按钮选择预设模板
3. 选择模板后，内容会自动填入编辑框
4. 根据任务要求修改提示词内容
5. 可参考 AI 分析的人物特征填写

### 第四步：选择图片比例

支持 5 种比例：
- **1:1** 正方形 (1024×1024)
- **16:9** 横屏 (1344×768)
- **9:16** 竖屏 (768×1344)
- **4:3** 标准 (1152×896)
- **3:4** 竖版 (896×1152)

### 第五步：生成图片

1. 点击 **「生成 4 张」** 按钮
2. 等待 AI 生成 4 张 2K 高清图片
3. 生成完成后可以：
   - **悬停图片**：显示放大和下载按钮
   - **点击放大**：全屏预览图片细节
   - **点击下载**：直接下载单张图片

### 第六步：选择并保存

1. 点击选择最满意的图片
2. 选中的图片会显示在右侧大图区域
3. 点击 **「保存到图库」** 保存并标记任务完成
4. 点击 **「下载」** 保存到本地

---

## 提示词模板详解

### 什么是模板？

模板是预设的提示词框架，包含可替换的变量占位符。使用模板可以：
- 快速生成符合蔡司风格的提示词
- 保持图片风格一致性
- 减少重复输入

### 模板变量语法

使用 `{变量名}` 格式插入变量，例如：

```
一位{年龄}的{性别}，{人物描述}，佩戴眼镜，{表情描述}。
场景：{场景描述}
风格：专业医疗说明图
```

### 预设模板

系统内置 3 个默认模板：

| 模板名称 | 适用场景 | 变量 |
|---------|---------|------|
| 通用人物场景 | 所有任务 | 年龄、性别、人物描述、表情描述、场景描述 |
| 视疲劳场景 | 瞳距偏差任务 | 眼镜位置描述、动作描述 |
| 老年人场景 | 装配高度任务 | 视觉问题描述、表情描述、场景描述 |

### 如何使用模板

**方法一：在工作区使用**
1. 在提示词编辑区点击 **「模板」** 按钮
2. 从下拉列表选择模板
3. 模板内容自动填入编辑框
4. 将 `{变量名}` 替换为实际内容

**方法二：管理模板**
1. 点击左侧导航 **「模板管理」**
2. 查看所有模板列表

### 创建自定义模板

1. 进入 **「模板管理」** 页面
2. 点击右上角 **「新建模板」**
3. 填写：
   - **模板名称**：便于识别的名字
   - **分类**：选择适用的任务类型
   - **模板内容**：提示词内容，用 `{变量名}` 标记变量
4. 点击 **「保存」**

---

## 图库功能

### 查看历史图片

1. 点击左侧导航 **「图库」**
2. 查看所有生成过的图片
3. 可按任务筛选

### 批量下载

1. 勾选要下载的图片
2. 点击 **「批量下载」**

---

## 常见问题

### Q: 生成失败怎么办？

1. 检查网络连接
2. 确认 Vercel 环境变量中已配置 `GEMINI_API_KEY`
3. 如果提示 413 错误，说明参考图太大，工具会自动压缩

### Q: 如何保持人物一致性？

上传参考图。AI 会参考图片中的人物特征生成新图片。

### Q: 模板变量没有被替换？

模板只是填充提示词框，你需要手动将 `{变量名}` 替换为实际内容。

### Q: 图片比例如何选择？

- **1:1**：适合头像、正方形展示
- **16:9**：适合横屏展示、PPT
- **9:16**：适合手机竖屏、海报
- **4:3/3:4**：适合传统照片比例

---

## 快捷操作

| 操作 | 说明 |
|-----|------|
| 拖拽上传 | 直接拖拽图片到参考图区域 |
| 悬停图片 | 显示放大和下载按钮 |
| 点击图片 | 选中图片 |
| 任务卡片 | 点击进入工作区 |

---

## 技术说明

- **AI 模型**：Gemini gemini-2.0-flash-exp-image-generation
- **图片分析**：Gemini gemini-2.0-flash
- **图片格式**：PNG
- **数据存储**：浏览器 localStorage（刷新不丢失）
- **部署平台**：Vercel
